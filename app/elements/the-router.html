<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="member-page/member-page.html">
<link rel="import" href="home-page/home-page.html">
<link rel="import" href="market-page/market-page.html">
<link rel="import" href="market-summary-page/market-summary-page.html">
<link rel="import" href="account-page/account-page.html">
<link rel="import" href="reserves-page/reserves-page.html">
<link rel="import" href="currency-page/currency-page.html">
<link rel="import" href="markdown-viewer/markdown-viewer.html">
<link rel="import" href="notfound-page/notfound-page.html">

<polymer-element name="the-router" flex>
  <template fit>
    <link rel="stylesheet" href="the-router.css">
    <core-ajax url="{{loginTestUrl}}" response="{{loginTestResp}}" id="loginTestAjax"></core-ajax>
    <app-router id="router" mode="hash" trailingSlash="ignore">
      <app-route path="/" element="home-page"></app-route>
      <app-route path="/member" element="member-page"></app-route>
      <app-route path="/member/:page" element="member-page"></app-route>
      <app-route path="/market" element="market-summary-page"></app-route>
      <app-route path="/market/:marketId" element="market-page"></app-route>
      <app-route path="/market/:marketId/:page" element="market-page"></app-route>
      <app-route path="/reserves" element="reserves-page"></app-route>
      <app-route path="/currency/:currencyId" element="currency-page"></app-route>
      <app-route path="/currency/:currencyId/:page" element="currency-page"></app-route>
      <app-route path="/doc/:file" element="markdown-viewer"></app-route>

      <template if="{{userId}}">
        <app-route path="/account" element="account-page"></app-route>
        <app-route path="/account/:page" element="account-page"></app-route>
        <app-route path="/member/signin" redirect="/member/signout"></app-route>
      </template>

      <template if="{{!userId}}">
        <app-route path="/account" redirect="/member/signin"></app-route>
        <app-route path="/account/:page" redirect="/member/signin"></app-route>
        <app-route path="/member/signout" redirect="/member/signedout"></app-route>
      </template>

      <app-route path="*" element="notfound-page"></app-route>
    </app-router>

    <paper-toast id="toast" text={{error}}></paper-toast>
  </template>

  <script src="the-router.js"></script>
</polymer-element>
