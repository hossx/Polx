<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-drawer-panel/core-drawer-panel.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../cp-globals/cp-globals.html">
<link rel="import" href="../cp-icons/crypto-icons.html">
<link rel="import" href="../cp-media-query/cp-media-query.html">
<link rel="import" href="../cp-footer/cp-footer.html">
<link rel="import" href="market-sidebar.html">
<link rel="import" href="trade-subpage/trade-subpage.html">
<link rel="import" href="kchart-subpage/kchart-subpage.html">
<link rel="import" href="recent-txs-subpage/recent-txs-subpage.html">
<link rel="import" href="orderbook-subpage/orderbook-subpage.html">

<polymer-element name="market-page" attributes="market">
  <template>
    <link rel="stylesheet" href="market-page.css">

    <cp-media-query smallup="{{smallup}}" small="{{small}}" mediumup="{{mediumup}}" medium="{{medium}}" large="{{large}}"></cp-media-query>
    <cp-globals id="globals"></cp-globals>
    <core-drawer-panel forceNarrow>

      <core-header-panel mode="seamed" id="drawer" drawer>
        <market-sidebar market="{{market}}"></market-sidebar>
      </core-header-panel>

      <core-header-panel mode="seamed" main>
        <core-toolbar class="core-header" id="toolbar">
          <a href="/#/market">
            <paper-icon-button icon="arrow-back"></paper-icon-button>
          </a>
          <paper-icon-button icon="menu" core-drawer-toggle></paper-icon-button>
          <div flex id="market-title">{{market}} ({{$.globals.configs.currencies[getTargetCoin(market)].label}})</div>
          <core-icon-button class="btn" smallup?="{{smallup}}" active?="{{tab === 0}}" on-tap="{{switchTab0}}" icon="swap-horiz"></core-icon-button>
          <core-icon-button class="btn" smallup?="{{smallup}}" active?="{{tab === 1}}" on-tap="{{switchTab1}}" icon="trending-up"></core-icon-button>
          <core-icon-button class="btn" smallup?="{{smallup}}" active?="{{tab === 2}}" on-tap="{{switchTab2}}" icon="list"></core-icon-button>
          <core-icon-button class="btn" smallup?="{{smallup}}" active?="{{tab === 3}}" on-tap="{{switchTab3}}" icon="history"></core-icon-button>
        </core-toolbar>

        <div id="canvas" flex vertical layout main>

          <core-animated-pages fit selected="{{tab}}" transitions="slide-from-right">
            <section>
              <trade-subpage market="{{market}}" fit></trade-subpage>
            </section>

            <section>
              <kchart-subpage></kchart-subpage>
            </section>

            <section>
              <orderbook-subpage></orderbook-subpage>
            </section>

            <section>
              <recent-txs-subpage></recent-txs-subpage>
            </section>
          </core-animated-pages>
          <paper-tabs id="nav-tabs" selected="{{tab}}" smallup?="{{smallup}}">
            <paper-tab>
              <core-icon icon="swap-horiz"></core-icon>
            </paper-tab>
            <paper-tab>
              <core-icon icon="trending-up"></core-icon>
            </paper-tab>
            <paper-tab>
              <core-icon icon="list"></core-icon>
            </paper-tab>
            <paper-tab>
              <core-icon icon="history"></core-icon>
            </paper-tab>
          </paper-tabs>
      </core-header-panel>
    </core-drawer-panel>
  </template>

  <script>
    (function() {
      'use strict';
      Polymer({
        tab: 2,
        bgcolor: 'black',
        marketChanged: function(oldV, newV) {
          this.bgcolor = this.$.globals.helpers.getTargetCoin(this.market).color;
        },
        getTargetCoin: function(market) {
          return market.substring(4);
        },
        switchTab0: function() {
          this.tab = 0;
        },
        switchTab1: function() {
          this.tab = 1;
        },
        switchTab2: function() {
          this.tab = 2;
        },
        switchTab3: function() {
          this.tab = 3;
        }
      })
    })();
  </script>
</polymer-element>
