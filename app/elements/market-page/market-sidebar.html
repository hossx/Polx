<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="market-sidebar-item.html">

<polymer-element name="market-sidebar" vertical layout attributes="marketId">
  <template>
    <link rel="stylesheet" href="market-sidebar.css">

    <paper-tabs id="market-tabs" valueattr="group" selected="{{selectedGroup}}">
      <template repeat="{{coin in marketGroupKeys}}">
        <paper-tab group="{{coin}}">{{coin}} MARKETS</paper-tab>
      </template>
    </paper-tabs>

    <core-animated-pages id="pages" valueattr="group" flex selected="{{selectedGroup}}">
      <template repeat="{{coin in marketGroupKeys}}">
        <section group="{{coin}}">
          <core-menu valueattr="market" selected="{{marketId}}">
            <template repeat="{{market in config.marketGroups[selectedGroup]}}">
              <market-sidebar-item active?="{{marketId===market.id}}" market="{{market}}"></market-sidebar-item>
            </template>
          </core-menu>
        </section>
      </template>
    </core-animated-pages>
  </template>

  <script>
    Polymer({
      ready: function() {
        this.config = window.config;
        this.marketGroupKeys = Object.keys(window.config.marketGroups);
        this.marketId = window.config.defaultMarket.id;
        this.selectedGroup = window.config.markets[this.marketId].baseCurrency.id;
      },
      marketIdChanged: function(o, n) {
        this.selectedGroup = window.config.markets[this.marketId].baseCurrency.id;
      }
    });
  </script>
</polymer-element>
