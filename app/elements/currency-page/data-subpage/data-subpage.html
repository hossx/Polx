<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../../../bower_components/marked-element/marked-element.html">
<link rel="import" href="../../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../crypto-address/crypto-address.html">
<link rel="import" href="../../section-group/section-group.html">

<polymer-element name="data-subpage" attributes="currency" flex>
  <template>
    <link rel="stylesheet" href="data-subpage.css">

    <section-group has-footer>
      <paper-shadow>
        <core-ajax id="txsAjax" url="{{txsUrl}}" on-core-complete="{{handleTxsComplete}}" auto></core-ajax>
        <div label>
          <h2>{{currency.name}} Transactions</h2>
          <p>The following blockchain transactions involve our {{currency.name}} addresses.</p>
        </div>
        <div class="card" vertical center layout>
          <table>
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>User ID</th>
                <th>Type</th>
                <th>Amount</th>
                <th>{{currency.id}} Address</th>
                <th>{{currency.id}} Transaction</th>
              </tr>
            </thead>
            <tbody>
              <template repeat="{{tx in transactions}}">
                <tr>
                  <td>{{tx[1]}}</td>
                  <td>
                    <a href="{{tx[2]}} | formatUserUrl}}">{{tx[2]}}</a>
                  </td>
                  <td>{{tx[3]}}</td>
                  <td>{{tx[4]}}</td>
                  <td>
                    <a href="{{tx[5]}} | formatAddrUrl}}">
                      <crypto-address class="{{group.label}}" currency="{{currency}}" addr="{{tx[5]}}"></crypto-address>
                    </a>
                  </td>
                  <td><a href="{{tx[6] | formatTxUrl}}">{{tx[6]}}</a>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
          <paper-button class="load-button" disabled?="{{!hasMoreTxs}}" on-tap="{{loadMoreTxs}}">Load more</paper-button>
        </div>
      </paper-shadow>

      <paper-shadow>
        <core-ajax id="snapshotAjax" url="{{snapshotUrl}}" on-core-complete="{{handleSnapshotsComplete}}" auto></core-ajax>
        <div label>
          <h2>{{currency.name}} Distributation Snapshots</h2>
          <p>The following files capture our {{currency.name}} distribution among all our users at certain time.</p>
        </div>
        <div class="card" vertical center layout>

          <table>
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>File</th>
                <th>Size</th>
              </tr>
            </thead>
            <tbody>
              <template repeat="{{snapshot in snapshots}}">
                <tr>
                  <td>{{snapshot[1]}}</td>
                  <td>
                    <a href="{{snapshot[2]}} | formatFileUrl}}">
                      <core-icon class="small" icon="file-download"></core-icon>{{snapshot[2]}}</a>
                  </td>
                  <td>{{snapshot[3]}}</td>
                </tr>
              </template>
            </tbody>
          </table>
          <paper-button class="load-button" disabled?="{{!hasMoreSnapshots}}" on-tap="{{loadMoreSnapshots}}">Load more</paper-button>
        </div>
      </paper-shadow>
    </section-group>
  </template>

  <script src="data-subpage.js"></script>
</polymer-element>
