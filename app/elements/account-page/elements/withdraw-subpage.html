<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../../bower_components/core-dropdown-menu/core-dropdown-menu.html">
<link rel="import" href="../../../bower_components/core-dropdown/core-dropdown.html">
<link rel="import" href="../../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../../bower_components/core-item/core-item.html">
<link rel="import" href="../../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../section-group/section-group.html">
<link rel="import" href="../../crypto-address/crypto-address.html">
<link rel="import" href="../../crypto-tx/crypto-tx.html">
<link rel="import" href="../../coinport-api/api-my-withdrawals.html">
<link rel="import" href="../../load-data-widget/load-data-widget.html">
<link rel="import" href="withdraw-widget.html">

<polymer-element name="withdraw-subpage" attributes="profile,currencyId,active,balance">
  <template>
    <link rel="stylesheet" href="withdraw-subpage.css">

    <section-group hasFooter="true" fit>
      <template if="{{profile}}">
        <paper-shadow z="0">
          <div label>
            <h2>{{M.withdraw}}</h2>
          </div>
          <div vertical center layout class="container1">
            <table>
              <tbody>
                <tr>
                  <th text-right>{{M.currencyToWithdraw}}</th>
                  <td>
                    <core-dropdown-menu label="{{currency.fullName}}" class="dropdownMenu">
                      <core-dropdown class="dropdown">
                        <core-menu valueattr="id" selected="{{currencyId}}">
                          <template repeat="{{c in currencyKeys}}">
                            <core-item id="{{c}}">{{config.currencies[c].fullName}}</core-item>
                          </template>
                        </core-menu>
                      </core-dropdown>
                    </core-dropdown-menu>
                  </td>
                </tr>
                <tr>
                  <th text-right>{{M.balance}}</th>
                  <td id="balance">
                    <nice-number p="4" v="{{selectedBalance}}" currency="{{currency}}" unit="{{currency.unit}}"></nice-number>
                  </td>
                </tr>
              </tbody>
            </table>

            <template if="{{currency.id == 'CNY'}}">
              <div class="instruction" vertical start layout>
                <template if="{{lang == 'zh'}}">
                  <div class="alsoNote">
                    <core-icon icon="info-outline"></core-icon>
                    <ul>
                      <li>每次提现的最小金额为 100 {{currency.unit}}。</li>
                      <li>{{currency.name}}提现需要人工处理，我们的服务时间是北京时间早10点到晚10点。</li>
                      <li>在上述时间内，您的提现一般会在一个小时内被处理。</li>
                    </ul>
                  </div>
                </template>

                <template if="{{lang == 'en'}}">
                  <div class="alsoNote">
                    <core-icon icon="info-outline"></core-icon>
                    <ul>
                      <li>The minimum amount for withdraw is 100 {{currency.unit}}.</li>
                      <li>Manual processing of {{currency.name}} is only available between 10:00AM and 10:00PM Beijing Time.</li>
                      <li>During the above hours, we nomally process your requests within 1 hour.</li>
                    </ul>
                  </div>
                </template>
              </div>
            </template>

            <template if="{{currency.id == 'GOOC'}}">
              <div class="instruction" vertical start layout>
                <template if="{{lang == 'zh'}}">
                  <div class="alsoNote">
                    <core-icon icon="info-outline"></core-icon>
                    <ul>
                      <li>每次提现的最小金额为 1000 {{currency.unit}}。</li>
                      <li>{{currency.name}}提现需要人工处理，我们的服务时间是北京时间早10点到晚10点。</li>
                      <li>在上述时间内，您的提现一般会在一个小时内到账。</li>
                    </ul>
                  </div>
                </template>
                <template if="{{lang == 'en'}}">
                  <div>Please send your {{currency.fullName}} to account:
                    <crypto-address currency="{{currency}}" addr="50001"></crypto-address>
                  </div>
                  <div class="alsoNote">
                    <core-icon icon="info-outline"></core-icon>
                    <ul>
                      <li>The minimum amount for withdraw is 1000 {{currency.unit}}.</li>
                      <li>Manual processing of {{currency.name}} is only available between 10:00AM and 10:00PM Beijing Time.</li>
                      <li>During the above hours, we nomally credit your account within 1 hour.</li>
                    </ul>
                  </div>
                </template>
              </div>
            </template>

            <template if="{{currency.id == 'XRP'}}">
              <div class="instruction" vertical start layout>
                <template if="{{lang == 'zh'}}">
                  <div>请将您的{{currency.name}}提现到:
                    <crypto-address currency="{{currency}}" addr="r9AzyYGGQAvgefdgeu3eDHaVdxLdpAvchE"></crypto-address>
                    或者
                    <crypto-address currency="{{currency}}" addr="coinportXrpwithdraw"></crypto-address>
                  </div>
                  <div class="warning">
                    <b>重要提示：</b> 转账时请一定把 “<b>{{profile.uid}}</b>”（您的用户ID，而不是您注册所有的email） 作为 “Destination Tag” 输入到钱包。不这么做您的提现不会成功！
                  </div>
                </template>

                <template if="{{lang == 'en'}}">
                  <div>Please send your {{currency.name}} to:
                    <crypto-address currency="{{currency}}" addr="r9AzyYGGQAvgefdgeu3eDHaVdxLdpAvchE"></crypto-address>
                    or
                    <crypto-address currency="{{currency}}" addr="coinportXrpwithdraw"></crypto-address>
                  </div>
                  <div class="warning">
                    <b>Attention:</b> Please make sure you put "{{profile.uid}}"(your user ID, not your email) as the "Destination
                    Tag". Failing to do so may invalid your withdraw!
                  </div>
                </template>
              </div>
            </template>

            <template if="{{currency.id == 'BTSX'}}">
              <div class="instruction" vertical start layout>
                <template if="{{lang == 'zh'}}">
                  <div>请将您的{{currency.name}}提现到:
                    <crypto-address currency="{{currency}}" addr="BTS5FPJkXFwokNEsRLwfWvPKAbzriNLS5ut823rMzHbpKMg9QgYWZ"></crypto-address>
                    或者
                    <crypto-address currency="{{currency}}" addr="coinport-withdraw"></crypto-address>
                  </div>
                  <div class="warning">
                    <b>重要提示：</b> 转账时请一定把 “<b>{{profile.uid}}</b>”（您的用户ID） 作为 “Memo” 输入到钱包。不这么做您的提现不会成功！
                  </div>
                </template>

                <template if="{{lang == 'en'}}">
                  <div>Please send your {{currency.name}} to:
                    <crypto-address currency="{{currency}}" addr="r9AzyYGGQAvgefdgeu3eDHaVdxLdpAvchE"></crypto-address>
                    or
                    <crypto-address currency="{{currency}}" addr="coinportXrpwithdraw"></crypto-address>
                  </div>
                  <div class="warning">
                    <b>Attention:</b> Please make sure you put "{{profile.uid}}"(your user ID) as the "Memo". Failing to do so may
                    invalid your withdraw!
                  </div>
                </template>
              </div>
            </template>

            <template if="{{currency.id == 'NXT'}}">
              <div class="instruction" vertical start layout>
                <div>Please send your {{currency.name}} to:
                  <crypto-address currency="{{currency}}" addr="{{nxtAddressComponents[0]}}"></crypto-address> or
                  <crypto-address currency="{{currency}}" addr="{{nxtAddressComponents[1]}}"></crypto-address>
                </div>
                <div>You can scan this QR code with your {{currency.name}} wallet:</div>

                <div self-center id="qrcode">
                  <qr-code data="{{nxtAddressComponents[0]}}" size="200" margin="1"></qr-code>
                </div>

                <div class="alsoNote">
                  <core-icon icon="info-outline"></core-icon>
                  <ul>
                    <li>This is a new address, pleae use it's public key: <span class="quote">{{nxtAddressComponents[2]}}</span>.</li>
                  </ul>
                </div>
              </div>
            </template>

            <template if="{{currency.id != 'CNY' && currency.id != 'GOOC' && currency.id != 'XRP' && currency.id != 'BTSX' && currency.id != 'NXT'}}">
              <div class="instruction" vertical center layout>
                <withdraw-widget currency="{{currency}}" balance="{{selectedBalance}}"></withdraw-widget>
              </div>
            </template>

          </div>
        </paper-shadow>

        <paper-shadow z="0">
          <div label>
            <h2>{{M.history}}</h2>
          </div>
          <div vertical center layout class="container2">
            <table class="simple">
              <thead>
                <tr>
                  <th>{{M.id}}</th>
                  <template if="{{currency.isCrypto}}">
                    <th>{{currency.id}} {{M.address}}</th>
                    <th>{{currency.id}} {{M.transaction}}</th>
                  </template>
                  <th text-right>{{M.quantity}}</th>
                  <th text-right>{{M.timestamp}}</th>
                  <th text-right>{{M.status}}</th>
                </tr>
              </thead>
              <tbody>
                <template repeat="{{d in withdrawals}}">
                  <tr>
                    <td>{{d.id}}</td>
                    <template if="{{currency.isCrypto}}">
                      <td>
                        <crypto-address currency="{{currency}}" addr="{{d.address}}"></crypto-address>
                      </td>
                      <td>
                        <template if="{{d.txid}}">
                          <crypto-tx currency="{{currency}}" tx="{{d.txid}}"></crypto-tx>
                        </template>
                        <template if="{{!d.txid}}">
                          {{M.na}}
                        </template>
                      </td>
                    </template>
                    <td text-right class="withdraw">
                      <nice-number v="{{d.amount}}" p="4"></nice-number>
                    </td>
                    <td text-right>{{d.created | formatTime}}</td>
                    <td text-right>{{M.statusLabels[d.status]}}</td>
                  </tr>
                </template>
              </tbody>
            </table>

            <api-my-withdrawals id="withdrawalsAjax" currencyId="{{currencyId}}" withdrawals="{{withdrawals}}" loading="{{loading}}"
            hasMore="{{hasMore}}" loadMore="{{loadMore}}" auto></api-my-withdrawals>
            <load-data-widget hasMore="{{hasMore}}" loading="{{loading}}" data="{{withdrawals}}" loadMore="{{loadMore}}"></load-data-widget>
          </div>
        </paper-shadow>
      </template>
    </section-group>

  </template>

  <script src="withdraw-subpage.js"></script>
</polymer-element>
