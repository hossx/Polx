<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../../bower_components/core-dropdown-menu/core-dropdown-menu.html">
<link rel="import" href="../../../bower_components/core-dropdown/core-dropdown.html">
<link rel="import" href="../../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../../bower_components/core-item/core-item.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../section-group/section-group.html">
<link rel="import" href="../../crypto-address/crypto-address.html">
<link rel="import" href="../../coinport-api/api-my-deposits.html">
<link rel="import" href="../../qr-code/qr-code.html">
<link rel="import" href="../../load-data-widget/load-data-widget.html">
<polymer-element name="deposit-subpage" attributes="profile,currencyId,active">
  <template>
    <link rel="stylesheet" href="deposit-subpage.css">
    <core-ajax id="depositAddrAjax" url="{{depositAddrUrl}}" response="{{depositAddrResp}}" auto></core-ajax>

    <section-group hasFooter="true" fit>
      <paper-shadow z="0">
        <div label>
          <h2>{{M.deposit}}</h2>
        </div>
        <div vertical center layout class="container1">

          <div id="select" center horizontal layout>
            <div class="label">Currency to deposit: </div>
            <core-dropdown-menu label="{{currency.fullName}}" class="dropdownMenu">
              <core-dropdown class="dropdown">
                <core-menu valueattr="id" selected="{{currencyId}}">
                  <template repeat="{{c in currencyKeys}}">
                    <core-item id="{{c}}">{{config.currencies[c].fullName}}</core-item>
                  </template>
                </core-menu>
              </core-dropdown>
            </core-dropdown-menu>
          </div>

          <template if="{{currency.id == 'CNY'}}">
            <div class="instruction" vertical layout>
              <p>There are two ways for you to deposit CNY.
              </p>
              <h3>Method 1</h3>
              <p>You can make {{currency.fullName}} deposits through our certified agents. Please contact them using Tencent
                <span class="highlight">QQ 498073256</span>. They will tell you one of their CNY bank accounts that you need to transfer
                money into.
              </p>
              <h3>Method 2</h3>
              <p>You may also deposit {{currency.name}} through our trusted Ripple gateways. Ripple deposit is near realtime and is
                more convinient. Please refer to <a href="/#/doc/cny-deposit-thru-ripple-gateways" target="_blank">this document</a>                for details.
              </p>
            </div>
          </template>
          <template if="{{currency.id == 'GOOC'}}">
            <div class="instruction" vertical layout>
              <p>Please send your {{currency.fullName}} to account <span class="highlight">50001</span> with and only with your id
                <span class="memo">afdafas</span> as the exact memo.
                <p>Please note:</p>
                <ul>
                  <li>The minimum amount for deposit is 1000 {{currency.unit}}.</li>
                  <li>Manual processing of {{currency.name}} is only available between 10:00AM and 10:00PM Beijing Time.</li>
                  <li>During the above hours, we nomally credit your account within 2 hours.</li>
                </ul>
                <p>Shall you have any questions, please contact us: <span class="highlight">QQ 1691767742</span>.
                </p>
            </div>
          </template>

          <template if="{{currency.isCrypto}}">
            <div class="instruction" vertical center layout>
              <div>Please send your {{currency.name}} to</div>
              <div>
                <crypto-address class="attention" currency="{{currency}}" addr="{{address}}"></crypto-address>
              </div>
              <div>You can scan this QR code with your {{currency.name}} wallet</div>
            </div>
            <div id="qrcode">
              <qr-code data="{{address}}" size="200" margin="1"></qr-code>
            </div>

          </template>
        </div>
      </paper-shadow>

      <paper-shadow z="0">
        <div label>
          <h2>{{M.history}}</h2>
        </div>
        <div vertical center layout class="container2">
          <table class="simple">
            <thead>
              <tr>
                <th>{{M.id}}</th>
                <th>{{currency.id}} {{M.address}}</th>
                <th>{{currency.id}} {{M.transaction}}</th>
                <th text-right>{{M.quantity}}</th>
                <th>{{M.timestamp}}</th>
              </tr>
            </thead>
            <tbody>
              <template repeat="{{d in deposits}}">
                <tr>
                  <td>{{d.id}}</td>
                  <td>
                    <crypto-address currency="{{currency}}" addr="{{d.address}}"></crypto-address>
                  </td>
                  <td><a href="{{d.txid | formatTxUrl}}">{{d.txid | formatTxLabel}}</a>
                  </td>
                  <td text-right>
                    <nice-number v="{{d.amount}}" p="4"></nice-number>
                  </td>
                  <td>{{d.created | formatTime}}</td>
                </tr>
              </template>
            </tbody>
          </table>

          <api-my-deposits id="depositsAjax" currencyId="{{currencyId}}" deposits="{{deposits}}" loading="{{loading}}" hasMore="{{hasMore}}" loadMore="{{loadMore}}" auto></api-my-deposits>
          <load-data-widget hasMore="{{hasMore}}" loading="{{loading}}" data="{{deposits}}" loadMore="{{loadMore}}"></load-data-widget>
        </div>
      </paper-shadow>
    </section-group>

  </template>

  <script src="deposit-subpage.js"></script>
</polymer-element>
